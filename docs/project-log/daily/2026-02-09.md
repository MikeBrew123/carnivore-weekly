# Daily Log: 2026-02-09

**Session Focus:** Revenue infrastructure sprint -- blog post fixes, template cleanup, affiliate/citation links

---

## Accomplishments

### Blog Post Date Fixes
- Fixed 6 future-dated blog posts (Feb 11/20 changed to Feb 9)
- Google penalizes future-dated content; these were live and indexed with wrong dates
- Deleted stale Feb 20 HTML files

### content_validator.py Bug Fix
- Double-slash regex was matching and breaking ALL `https://` URLs sitewide
- Every URL on the site was being corrupted by the validator meant to protect quality
- Root cause: overly aggressive regex pattern for path doubling detection
- Fix applied, all URLs now pass validation correctly

### Blog Template Script Injection
- Added `calculator-cta.js` and `newsletter-inject.js` to Jinja2 blog template
- Pipeline-generated posts were missing these revenue scripts entirely
- Both scripts now load on every blog post automatically

### Template HTML Deduplication
- Stripped baked-in template HTML from 5 new posts' content fields
- Reaction buttons, wiki links, featured videos, and post footers were being duplicated
- Root cause: content agents were including template HTML in their content output
- Fix: cleaned content fields so template handles structure, content fields hold only content

### Hardcoded Content Removed from Template
- Removed hardcoded wiki links (cholesterol/electrolytes/digestion) from blog template
- Removed hardcoded Anthony Chaffee video embed from blog template
- Every post was showing these regardless of topic relevance
- Template now only includes dynamic content

### Template Tag Fix
- Replaced empty `{{ tag1 }}` placeholders with dynamic `{% for tag in tags %}` loop
- Tags now render from actual post data in `blog_posts.json`

### Reference Link Wiring
- Wired 24 reference links across 5 posts
- 6 books: Amazon affiliate links (title-only, no cover images)
- 10 studies: PubMed links with full citation format
- All links validated and committed

### Git Activity
- 4 commits pushed to main
- Pre-commit validation passing on all commits

---

## In Progress
- Tag CSS styling: `.tag` class is unstyled, tags render as raw unstyled text
- Author bio field: `author_bio` referenced in template but never passed from generator; all posts show empty bio

---

## Blockers
- None critical. Tag styling and author bio are cosmetic.

---

## Decisions Made
1. **Affiliate link format:** Book references get Amazon affiliate links (title-only), studies get PubMed links (full citation)
2. **Template cleanup:** Hardcoded wiki links and featured video sections removed from template -- these should be dynamic or omitted entirely
3. **Content agent brief:** Next blog batch, content agents get a clean brief so they produce CLEAN content fields (no template HTML in content output)

---

## Lessons Learned
- **content_validator.py regex scope:** Validation rules that match common URL patterns (like double slashes) will break everything. Test regex against `https://` before deploying.
- **Content field boundaries:** Content agents must be told explicitly what belongs in their content field vs. what the template handles. Without clear boundaries, they duplicate template structure.
- **Future dates matter:** Google penalizes future-dated posts. Any post with a publish date in the future must be caught before commit.

---

## Next Session Priorities
1. Fix `.tag` CSS styling in blog post footer
2. Fix `author_bio` field -- either populate in blog_posts.json or remove from template
3. Continue revenue sprint (Stripe checkout, calculator CTAs, newsletter growth)
4. Write next batch of blog posts using agents with clean content brief
